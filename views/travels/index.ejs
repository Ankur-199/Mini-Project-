<%- include('../partials/header') %>

<div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="bi bi-map"></i> All Travels</h2>
    <a href="/travels/new" class="btn btn-primary">
        <i class="bi bi-plus-circle"></i> Add New Travel
    </a>
</div>

<% if (typeof error !== 'undefined') { %>
    <div class="alert alert-danger">
        <%= error %>
    </div>
<% } %>

<% if (travels && travels.length > 0) { %>
    <div class="row">
        <% travels.forEach(travel => { %>
            <div class="col-md-6 col-lg-4 mb-4">
                <div class="card h-100 shadow-sm">
                    <div class="card-body">
                        <h5 class="card-title">
                            <i class="bi bi-geo-alt-fill text-primary"></i> <%= travel.destination %>
                        </h5>
                        <p class="card-text text-muted">
                            <%= travel.description.length > 100 ? travel.description.substring(0, 100) + '...' : travel.description %>
                        </p>
                        <div class="mb-2">
                            <small class="text-muted">
                                <i class="bi bi-calendar"></i> 
                                <%= new Date(travel.startDate).toLocaleDateString() %> - 
                                <%= new Date(travel.endDate).toLocaleDateString() %>
                            </small>
                        </div>
                        <div class="mb-2">
                            <span class="badge bg-<%= 
                                travel.status === 'Planning' ? 'warning' : 
                                travel.status === 'Booked' ? 'info' : 
                                travel.status === 'In Progress' ? 'primary' : 
                                travel.status === 'Completed' ? 'success' : 
                                'secondary' 
                            %>">
                                <%= travel.status %>
                            </span>
                        </div>
                        <div class="mb-2">
                            <small>
                                <i class="bi bi-people"></i> <%= travel.travelers %> travelers
                                <span class="ms-3">
                                    <i class="bi bi-currency-dollar"></i> $<%= travel.budget.toLocaleString() %>
                                </span>
                            </small>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent">
                        <a href="/travels/<%= travel._id %>" class="btn btn-sm btn-outline-primary">
                            <i class="bi bi-eye"></i> View
                        </a>
                        <a href="/travels/<%= travel._id %>/edit" class="btn btn-sm btn-outline-secondary">
                            <i class="bi bi-pencil"></i> Edit
                        </a>
                        <form action="/travels/<%= travel._id %>?_method=DELETE" method="POST" class="d-inline">
                            <button type="submit" class="btn btn-sm btn-outline-danger" onclick="return confirm('Are you sure you want to delete this travel?')">
                                <i class="bi bi-trash"></i> Delete
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        <% }); %>
    </div>
<% } else { %>
    <div class="alert alert-info text-center">
        <i class="bi bi-info-circle"></i> No travels found. 
        <a href="/travels/new" class="alert-link">Add your first travel!</a>
    </div>
<% } %>

<%- include('../partials/footer') %>

